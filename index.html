<!DOCTYPE html><html>
<head>
   <title>StevenWu Design</title>
   <meta name="description" content="Steven Wu The F2E Web Redesign">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="shortcut icon" href="Assets/image/favicon.png" type="image/x-icon">
   <link rel="stylesheet" href="Assets/Content/bootstrap.css">
   <link rel="stylesheet" href="Assets/Content/index.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top py-1">
    <a class="navbar-brand" href="#">Reality</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="#">首頁</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="#">資訊圖表 <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">未來UI設計</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Noob攻略</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            其他
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="#">爬爬爬</a>
            <a class="dropdown-item" href="#">3d Modal</a>
          </div>
        </li>
      </ul>
    </div>

  </nav>
  <div class="content-body">
    <div class="chart-container">
      <canvas id="canvas"></canvas>
    </div>
  </div>
</body>
<script src="Assets/javascript/jquery.min.js"></script>
<script src="Assets/javascript/bootstrap.min.js"></script>
<script src="Assets/javascript/chart.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
<script src="Assets/javascript/chartjs-plugin-zoom.min.js"></script>

<script>
  const imageURLs = [
  'https://i.stack.imgur.com/2RAv2.png',
  'https://i.stack.imgur.com/Tq5DA.png',
  'https://i.stack.imgur.com/3KRtW.png',
  'https://i.stack.imgur.com/iLyVi.png',
  'https://i.stack.imgur.com/2RAv2.png',
  'https://i.stack.imgur.com/Tq5DA.png',
  'https://i.stack.imgur.com/3KRtW.png',
  'https://i.stack.imgur.com/iLyVi.png'
  ];
  const images = imageURLs.map(v => {
  var image = new Image();
  image.src = v;
  return image;
  });
  

  var currency_ratio=[13,13,12,18,12];//波巴查愛莎 E計算
    $.getJSON("Assets/graph.json", function(json_file) {
   var x_array= json_file.objects.map(function(item) {
     switch(item.server){
       case '波利':{
        return Math.floor((item.Virtual_currency/currency_ratio[0])*10000);
       }
       case '巴基力':{
        return Math.floor((item.Virtual_currency/currency_ratio[1])*10000);
       }
       case '查爾斯':{
        return Math.floor((item.Virtual_currency/currency_ratio[2])*10000);
       }
       case '愛麗絲':{
        return Math.floor((item.Virtual_currency/currency_ratio[3])*10000);
       }
       case '沙拉':{
        return Math.floor((item.Virtual_currency/currency_ratio[4])*10000);
       }
       default: {
        console.log('Empty action received.');
     }
    }
   });
   var y_array = json_file.objects.map(function(item) {
      return item.Damage;
   });
   var name = json_file.objects.map(function(item) {
      return item.name;
   });
   var job = json_file.objects.map(function(item) {
      return item.job;
   });
          
   var sites = [];
   for(var i = 0; i < json_file.objects.length; i++){
    var job_selector = job[i];
        switch (job_selector) {
          case '盧':
            job_number = 1;
            break;
          case '皇':
            job_number = 2;
            break;
          case '遊':
            job_number = 3;
            break;
          case '斬':
            job_number = 4;
            break;
          case '基':
            job_number = 5;
            break;
          default:
            console.log(`Sorry, we are out of`);
        }

        var site = {
            label:name[i],
            backgroundColor: '#ffe2c9',
            borderColor: '#fdb5b5',
            pointRadius: 10,
            pointHoverRadius: 14,
            borderWidth:2,
            pointStyle:('circle',images[job_number]),
            data:[{
            x: Number(x_array[i]),
            y: Number(y_array[i]),
            }],
      };
      sites.push(site);
    }
    var data = {datasets: sites};
    var ctx = document.getElementById('canvas').getContext('2d');
    var chart = new Chart(ctx, {
      type: 'scatter',
      data: data,
      options: {
         maintainAspectRatio:false,
         responsive: true,
         plugins:{
            zoom: {
              limits:{
                y:{min:-0,max:100000,minRange:1000},
                x:{min:-0,max:150000,minRange:1000},
              },
              pan: {
                enabled: true,
                mode: 'xy',
              },
              zoom: {
                wheel: {
                  enabled: true,
                },
                pinch: {
                  enabled: true,
                },
                mode: 'xy',
              },
            },
            title:{
              text:'關係圖',
              display:true,
              font:{
                size:20,
              },
            },
            legend: {
            display: false,
            },
          },
    scales: {
        y:{
            border:{
              color:"#cccccc",
              width:2,
            },
            display:true,
            max:10000,
            ticks: {
                stepSize: 1000,
                color:"#666",
                beginAtZero: true,
                precision:0,
                callback: (value, index, ticks) => {
                    if(index === 0 || index === ticks.length - 1){
                      return null;
                    }
                    else
                          if(value >= 10000){
                            return Math.floor(value/1000) + 'M';
                          }
                          else
                        return Math.floor(value) + 'K';
                      
                  }
            }
        },
        x: {
            border:{
              display:false,
            },
            display: true,
            max: 50000,
            ticks: {
                stepSize: 5000,
                color:"#666",
                beginAtZero: true,
                precision:0,
                callback: (value, index, ticks) => {
                  if(index === 0 || index === ticks.length - 1){
                      return null;
                    }
                    else
                        return Math.floor(value) + '$';
                    }
            }
        },
        }
      },
   });
});

</script>
</html>