<!DOCTYPE html><html>
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NHCJY83598"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NHCJY83598');
</script>
   <title>R科學-資訊圖表(經驗值)</title>
   <meta name="description" content="R科學，本網站旨在將Ragnarok Online的各種數據以圖像化呈現。">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="shortcut icon" href="Assets/image/favicon.png" type="image/x-icon">
   <link rel="stylesheet" href="Assets/Content/bootstrap.css">
   <link rel="stylesheet" href="Assets/Content/index.css">
</head>
<body>
  <nav id="nav" class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="index.html"><img src="Assets/image/logo.png"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="index.html">資訊圖表中心</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">未來UI設計</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">低成本三王</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">3D Modal</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="content-body p-1">
    <div id="chart-box-layout">
      <div class="infographic_graphic_section p-1">
        <div id="controler" class="controler mb-2">
          
        </div>
        <div class="chart-container">
          <canvas id="canvas"></canvas>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="Assets/javascript/jquery.min.js"></script>
<script src="Assets/javascript/bootstrap.min.js"></script>
<script src="Assets/javascript/chart.umd.js"></script>

<script>
  $(document).ready(function () {
    var winHeight = window.innerHeight;

window.addEventListener('resize', function(event){
    winHeight = window.innerHeight;
    if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
    // true for mobile device
      $('.content-body').css("height",`calc(${winHeight}px - ${nav_height}px`);
       }
});
  var nav_height = $('#nav').outerHeight();
  var content_height = $('.content-body').innerHeight();

  if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
  // true for mobile device
  $('.content-body').css("max-height",`calc(${wwinHeight}px - ${nav_height}px`);
  }else{
    // false for not mobile device
    $('.content-body').css("max-height",`calc(100vh - ${nav_height}px`);
  }
  });
 
</script>
<script>
  var chart;
  var sites = [];
  var data = {datasets: sites};
  const ctx = document.getElementById('canvas').getContext('2d');

  Chart.register({
        id:'vertical_line',
        afterDraw: chart => {
            if (chart.tooltip?._active?.length) {               
               let x = chart.tooltip._active[0].element.x;             
               let yAxis = chart.scales.y;
               let ctx = chart.ctx;
               ctx.save();
               ctx.beginPath();
               ctx.moveTo(x, yAxis.top);
               ctx.lineTo(x, yAxis.bottom);
               ctx.lineWidth = 1;
               ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
               ctx.stroke();
               ctx.restore();
            }
          }
      });
  //json轉檔
  JsonTransition();
  function JsonTransition(){
  $.getJSON("Assets/json/exp.json", function(json_file) {
   //json to array
   x_array = json_file.Level_exp.map(function(item) {
      return {
        'x':item.level,
        'y':item.l_exp
      };
   });

   //load data
   load_data();
    // draw chart
    init();
  });
};

  const options ={
        maintainAspectRatio:false,
        responsive: true,
        interaction: {
          intersect: false,
          mode: 'index',
        },
         plugins:{
            title:{
              display:false,
              color:'#fff',
              position:"bottom",
              font:{size:20,},
            },
            legend: {
            display: true,
              labels:{
                color:'#eee',
              }
            }, 
          },
         
          scales: { 
            y:{
                grid: {color: 'rgba( 160, 255, 240, 0.2)',},
                border:{color:"rgba( 160, 255, 240, 0.25)",width:1,},
                display:true,
                min:0,
                ticks: {
                    color:"#eee",
                    beginAtZero: true,
                    precision:0,
                    padding: 8,
                    crossAlign: 'start',
                    callback: (value, index, ticks) => {
                      if(index === ticks.length - 1 || index === 0){return null;}
                      else
                          if(value >= 100000000){return Math.floor(value/100000000) + '億';}
                          else
                            return Math.floor(value/10000000) + '千萬';
                    }
                }
            },
            x: { 
              ticks: {
                    color:"#eee",
                },
              grid: {
                color: 'rgba( 160, 255, 240, 0.2)',
                },
                border:{display:false,},
                display: true,
            },      
          },
        };
  
  const config = {
      type: 'line',
      data: data,
      options:options,
      };
  function init() {
  chart = new Chart(ctx, config);
    };
</script>
<script>
  function load_data(){
            var site = {
                label:'等級經驗值',
                data:x_array,
                tension: 1,
                pointRadius:5,
            };
          sites.push(site);
    };
</script>
</html>