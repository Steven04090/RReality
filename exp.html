
    <div id="chart-box-layout">
      <div class="infographic_graphic_section p-1">
        <div id="controler" class="controler mb-2">
          
        </div>
        <div class="chart-container">
          <canvas id="canvas"></canvas>
        </div>
      </div>
    </div>

<script>
  var chart;
  var sites = [];
  var data = {datasets: sites};
  const ctx = document.getElementById('canvas').getContext('2d');

  Chart.register({
        id:'vertical_line_and_x_axis_text',
        afterDraw: chart => {
            //x axis
            const{ ctx, chartArea:{top,bottom,right},scales:{x,y}}= chart;
            ctx.save();
            ctx.font ='12px Arial';
            ctx.fillStyle = '#f1f1f1';
            ctx.fillText('(Exp)',0, top -10);
            ctx.restore();

            if (chart.tooltip?._active?.length) {               
               let x = chart.tooltip._active[0].element.x;             
               let yAxis = chart.scales.y;
               let ctx = chart.ctx;
               ctx.save();
               ctx.beginPath();
               ctx.moveTo(x, yAxis.top);
               ctx.lineTo(x, yAxis.bottom);
               ctx.lineWidth = 1;
               ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
               ctx.stroke();
               ctx.restore();
            }
          }
      });
  //json轉檔
  JsonTransition();
  function JsonTransition(){
  $.getJSON("Assets/json/exp.json", function(json_file) {
   //json to array
   x_array = json_file.Level_exp.map(function(item) {
      return {
        'x':item.level,
        'y':item.l_exp
      };
   });

   //load data
   load_data();
    // draw chart
    init();
  });
};

  const options ={
        maintainAspectRatio:false,
        responsive: true,
        interaction: {
          intersect: false,
          mode: 'index',
        },
         plugins:{
            title:{
              display:false,
              color:'#fff',
              position:"bottom",
              font:{size:20,},
            },
            legend: {
            display: true,
              labels:{
                color:'#eee',
              }
            }, 
          },
         
          scales: { 
            y:{
                grid: {color: 'rgba( 160, 255, 240, 0.2)',},
                border:{color:"rgba( 160, 255, 240, 0.25)",width:1,},
                display:true,
                min:0,
                ticks: {
                    color:"#eee",
                    beginAtZero: true,
                    precision:0,
                    padding: 8,
                    crossAlign: 'start',
                    callback: (value, index, ticks) => {
                      if(index === ticks.length - 1 || index === 0){return null;}
                      else
                          if(value >= 100000000){return Math.floor(value/100000000) + '億';}
                          else
                            return Math.floor(value/10000000) + '千萬';
                    }
                }
            },
            x: { 
              ticks: {
                    color:"#eee",
                },
              grid: {
                color: 'rgba( 160, 255, 240, 0.2)',
                },
                border:{display:false,},
                display: true,
            },      
          },
        };
  
  const config = {
      type: 'line',
      data: data,
      options:options,
      };
  function init() {
  chart = new Chart(ctx, config);
    };
</script>
<script>
  function load_data(){
            var site = {
                label:'等級經驗值',
                data:x_array,
                tension: 1,
                pointRadius:5,
            };
          sites.push(site);
    };
</script>
</html>