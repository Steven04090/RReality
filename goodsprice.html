<!DOCTYPE html><html>
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NHCJY83598"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NHCJY83598');
</script>
   <title>R科學-資訊圖表(87z物價走勢)</title>
   <meta name="description" content="R科學">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <meta charset="utf-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="shortcut icon" href="Assets/image/favicon.png" type="image/x-icon">
   <link rel="stylesheet" href="Assets/Content/bootstrap.css">
   <link rel="stylesheet" href="Assets/Content/index.css">
</head>
<body>
  <nav id="nav" class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="index.html"><img src="Assets/image/logo.png"></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
          <a class="nav-link" href="index.html">資訊圖表中心</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">未來UI設計</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">低成本三王</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">3D Modal</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="content-body p-1">
    <div id="chart-box-layout">
      <div class="infographic_graphic_section p-1">
        <div id="controler" class="controler mb-2">
          
        </div>
        <div class="chart-container">
          <canvas id="canvas"></canvas>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="Assets/javascript/jquery.min.js"></script>
<script src="Assets/javascript/bootstrap.min.js"></script>
<script src="Assets/javascript/chart.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
<script src="Assets/javascript/chartjs-plugin-zoom.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@^2"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment"></script>

<script>
  //moment.js轉中文
  moment.locale('zh-tw', {
      months: '一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月'.split('_'),
      monthsShort: '1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月'.split('_'),
      weekdays: '星期日_星期一_星期二_星期三_星期四_星期五_星期六'.split('_'),
      weekdaysShort: '周日_周一_周二_周三_周四_周五_周六'.split('_'),
      weekdaysMin: '日_一_二_三_四_五_六'.split('_'),
      longDateFormat: {
        LT: 'Ah點mm分',
        LTS: 'Ah點m分s秒',
        L: 'YYYY-MM-DD',
        LL: 'YYYY年MMMD日',
        LLL: 'YYYY年MMMD日Ah點mm分',
        LLLL: 'YYYY年MMMD日ddddAh點mm分',
        l: 'YYYY-MM-DD',
        ll: 'YYYY年MMMD日',
        lll: 'YYYY年MMMD日Ah點mm分',
        llll: 'YYYY年MMMD日ddddAh點mm分'
      },
      meridiemParse: /凌晨|早上|上午|中午|下午|晚上/,
      meridiemHour: function (h, meridiem) {
        let hour = h;
        if (hour === 12) {
          hour = 0;
        }
        if (meridiem === '凌晨' || meridiem === '早上' ||
          meridiem === '上午') {
          return hour;
        } else if (meridiem === '下午' || meridiem === '晚上') {
          return hour + 12;
        } else {
          // '中午'
          return hour >= 11 ? hour : hour + 12;
        }
      },
      meridiem: function (hour, minute, isLower) {
        const hm = hour * 100 + minute;
        if (hm < 600) {
          return '凌晨';
        } else if (hm < 900) {
          return '早上';
        } else if (hm < 1130) {
          return '上午';
        } else if (hm < 1230) {
          return '中午';
        } else if (hm < 1800) {
          return '下午';
        } else {
          return '晚上';
        }
      },
      calendar: {
        sameDay: function () {
          return this.minutes() === 0 ? '[今天]Ah[點整]' : '[今天]LT';
        },
        nextDay: function () {
          return this.minutes() === 0 ? '[明天]Ah[點整]' : '[明天]LT';
        },
        lastDay: function () {
          return this.minutes() === 0 ? '[昨天]Ah[點整]' : '[昨天]LT';
        },
        nextWeek: function () {
          let startOfWeek, prefix;
          startOfWeek = moment().startOf('week');
          prefix = this.diff(startOfWeek, 'days') >= 7 ? '[下]' : '[本]';
          return this.minutes() === 0 ? prefix + 'dddA點整' : prefix + 'dddAh點mm';
        },
        lastWeek: function () {
          let startOfWeek, prefix;
          startOfWeek = moment().startOf('week');
          prefix = this.unix() < startOfWeek.unix() ? '[上]' : '[本]';
          return this.minutes() === 0 ? prefix + 'dddAh點整' : prefix + 'dddAh點mm';
        },
        sameElse: 'LL'
      },
      ordinalParse: /\d{1,2}(日|月|周)/,
      ordinal: function (number, period) {
        switch (period) {
          case 'd':
          case 'D':
          case 'DDD':
            return number + '日';
          case 'M':
            return number + '月';
          case 'w':
          case 'W':
            return number + '周';
          default:
            return number;
        }
      },
      relativeTime: {
        future: '%s内',
        past: '%s前',
        s: '幾秒',
        m: '1 分鐘',
        mm: '%d 分鐘',
        h: '1 小時',
        hh: '%d 小時',
        d: '1 天',
        dd: '%d 天',
        M: '1 個月',
        MM: '%d 个月',
        y: '1 年',
        yy: '%d 年'
      },
      week: {
        // GB/T 7408-1994《数据元和交换格式·信息交换·日期和时间表示法》与ISO 8601:1988等效
        dow: 1, // Monday is the first day of the week.
        doy: 4  // The week that contains Jan 4th is the first week of the year.
      }
    });

  $(document).ready(function () {
    var nav_height = $('#nav').outerHeight();
    var content_height = $('.content-body').innerHeight();

    if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
    // true for mobile device
    $('.content-body').css("max-height",`calc(${window.innerHeight} - ${nav_height}px`);
    }else{
      // false for not mobile device
      $('.content-body').css("max-height",`calc(100vh - ${nav_height}px`);
    }
  });
 
</script>
<script>

</script>
<script>
  var chart;
  var sites = [];
  var data = {datasets: sites};
  const ctx = document.getElementById('canvas').getContext('2d');
  //json轉檔
  JsonTransition();
  function JsonTransition(){
  $.getJSON("Assets/json/game_price.json", function(json_file) {
   //json to array
   x_array = json_file.Blacksmith_Blessing.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });
   y_array = json_file.Hyperspace_Gem_Rough_Stone.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });

   z_array = json_file.Old_Card_Album.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });
   a_array = json_file.honor_rose.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });
   b_array = json_file.mystery_spell_book.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });
   c_array = json_file.Enriched_Elunium_Box.map(function(item) {
      return {
        'x':item.date,
        'y':item.sell_price
      };
   });
   //load data
   load_data();
    // draw chart
    init();
  });
};

  const zoomOptions = {
    limits:{
        y:{min:'original',max:'original'},
        x:{min:'original', max: 'original',minRange:3600*1000*24 },//time base on 1000
      },
      pan: {
        enabled: true,
        mode: 'xy',
      },
      zoom:{
        mode: 'xy',
        wheel: {
          enabled: true,
        },
        pinch: {
          enabled: true,
        },
        //zoom 改變x軸顯示
        onZoomComplete({chart}) {

        chart.update('none');
       }
      },
    }
  const options ={
        maintainAspectRatio:false,
        responsive: true,
        interaction: {
          intersect: false,
          mode: 'nearest',
        },
         plugins:{
            zoom: zoomOptions,
            title:{
              display:false,
              color:'#fff',
              position:"bottom",
              font:{size:20,},
            },
            legend: {
            display: true,
              labels:{
                color:'#eee',
              }
            }, 
          },
         
          scales: { 
            y:{
                grid: {color: 'rgba( 160, 255, 240, 0.2)',},
                border:{color:"rgba( 160, 255, 240, 0.25)",width:1,},
                display:true,
                min:0,
                ticks: {
                    color:"#eee",
                    beginAtZero: true,
                    precision:0,
                    padding: 8,
                    crossAlign: 'start',
                }
            },
            x: { 
              ticks: {
                    color:"#eee",
                },
              grid: {
                color: 'rgba( 160, 255, 240, 0.2)',
                },
                type: 'time',
                  time: {
                    tooltipFormat: 'YYYY/MM/DD',
                    unit:  'day',
                },
                border:{display:false,},
                display: true,
            },      
          },
        };
  
  const config = {
      type: 'line',
      data: data,
      options:options,
      };
  function init() {
  chart = new Chart(ctx, config);
    };
</script>
<script>
  function load_data(){
            var site = {
                label:'鐵匠的祝福',
                data:x_array,
                tension: 1,
                pointRadius:5,
            };
            var site2 = {
                label:'超時空寶石原石',
                data:y_array,
                tension: 1,
                pointRadius:5,
            };
            var site3 = {
                label:'老舊收集冊',
                data:z_array,
                tension: 1,
                pointRadius:5,
            };
            var site4 = {
                label:'榮譽玫瑰',
                data:a_array,
                tension: 1,
                pointRadius:5,
            };
            var site5 = {
                label:'神秘咒語集',
                data:b_array,
                tension: 1,
                pointRadius:5,
            };
            var site6 = {
                label:'濃縮鋁箱子',
                data:c_array,
                tension: 1,
                pointRadius:5,
            };
          sites.push(site);
          sites.push(site2);
          sites.push(site3);
          sites.push(site4);
          sites.push(site5);
          sites.push(site6);
    };
</script>
<script>
  //zoom區
  function resetZoom() {
  chart.resetZoom();
}

</script>
</html>